<!DOCTYPE html> <html lang="en"><head> <meta charset="utf-8"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <meta name="viewport" content="width=device-width, initial-scale=1"><title>Help your user rate and review your iOS app!</title><!-- Begin Jekyll SEO tag v2.8.0 --> <meta name="generator" content="Jekyll v3.9.2" /> <meta property="og:title" content="Help your user rate and review your iOS app!" /> <meta name="author" content="Ioannis Diamantidis" /> <meta property="og:locale" content="en_US" /> <meta name="description" content="A post about the importance of ratings and reviews for an iOS app and how to add them using SKStoreReviewController or an App Store link." /> <meta property="og:description" content="A post about the importance of ratings and reviews for an iOS app and how to add them using SKStoreReviewController or an App Store link." /> <link rel="canonical" href="https://diamantidis.github.io/2020/04/05/app-reviews-for-iOS-apps" /> <meta property="og:url" content="https://diamantidis.github.io/2020/04/05/app-reviews-for-iOS-apps" /> <meta property="og:site_name" content="Ioannis Diamantidis" /> <meta property="og:image" content="https://diamantidis.github.io/assets/socialIcon.png" /> <meta property="og:type" content="article" /> <meta property="article:published_time" content="2020-04-05T04:00:00+00:00" /> <meta name="twitter:card" content="summary" /> <meta property="twitter:image" content="https://diamantidis.github.io/assets/socialIcon.png" /> <meta property="twitter:title" content="Help your user rate and review your iOS app!" /> <meta name="twitter:site" content="@diamantidis_io" /> <meta name="twitter:creator" content="@diamantidis_io" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Ioannis Diamantidis","url":"https://diamantidis.github.io"},"dateModified":"2020-04-05T04:00:00+00:00","datePublished":"2020-04-05T04:00:00+00:00","description":"A post about the importance of ratings and reviews for an iOS app and how to add them using SKStoreReviewController or an App Store link.","headline":"Help your user rate and review your iOS app!","image":"https://diamantidis.github.io/assets/socialIcon.png","mainEntityOfPage":{"@type":"WebPage","@id":"https://diamantidis.github.io/2020/04/05/app-reviews-for-iOS-apps"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://diamantidis.github.io/assets/socialIcon.png"},"name":"Ioannis Diamantidis"},"url":"https://diamantidis.github.io/2020/04/05/app-reviews-for-iOS-apps"}</script> <!-- End Jekyll SEO tag --> <link rel="stylesheet" href="/assets/main.css"><link rel="apple-touch-icon" href="/assets/apple-touch-icon.png"/> <link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon-32x32.png"> <link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon-16x16.png"> <link rel="manifest" href="/assets/site.webmanifest"> <link rel="mask-icon" href="assets/safari-pinned-tab.svg" color="#5bbad5"> <link rel="shortcut icon" href="/assets/favicon.ico"> <meta name="msapplication-TileColor" content="#da532c"> <meta name="msapplication-config" content="/assets/browserconfig.xml"> <meta name="theme-color" content="#ffffff"><!-- Buy me a coffee widget --> <script data-name="BMC-Widget" data-cfasync="false" src="https://cdnjs.buymeacoffee.com/1.0.0/widget.prod.min.js" data-id="diamantidis" data-description="Support me on Buy me a coffee!" data-message="" data-color="#347ab7" data-position="Right" data-x_margin="18" data-y_margin="18"></script> <link href="//maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet"><link type="application/atom+xml" rel="alternate" href="https://diamantidis.github.io/feed.xml" title="Ioannis Diamantidis" /><script src="https://cdn.telemetrydeck.com/websdk/telemetrydeck.min.js" data-app-id='38585865-E115-4830-8D37-7A8F1213DC6B' ></script> <script> !function(t,e){var o,n,p,r;e.__SV||(window.posthog=e,e._i=[],e.init=function(i,s,a){function g(t,e){var o=e.split(".");2==o.length&&(t=t[o[0]],e=o[1]),t[e]=function(){t.push([e].concat(Array.prototype.slice.call(arguments,0)))}}(p=t.createElement("script")).type="text/javascript",p.async=!0,p.src=s.api_host+"/static/array.js",(r=t.getElementsByTagName("script")[0]).parentNode.insertBefore(p,r);var u=e;for(void 0!==a?u=e[a]=[]:a="posthog",u.people=u.people||[],u.toString=function(t){var e="posthog";return"posthog"!==a&&(e+="."+a),t||(e+=" (stub)"),e},u.people.toString=function(){return u.toString(1)+".people (stub)"},o="capture identify alias people.set people.set_once set_config register register_once unregister opt_out_capturing has_opted_out_capturing opt_in_capturing reset isFeatureEnabled onFeatureFlags getFeatureFlag getFeatureFlagPayload reloadFeatureFlags group updateEarlyAccessFeatureEnrollment getEarlyAccessFeatures getActiveMatchingSurveys getSurveys".split(" "),n=0;n<o.length;n++)g(u,o[n]);e._i.push([i,s,a])},e.__SV=1)}(document,window.posthog||[]); posthog.init('phc_sTVQpj2y4ME7gaB3ETrOfwqd4B78MrA2ixW11xju0Hg',{api_host:'https://eu.posthog.com'}) </script></head> <body><header class="site-header" role="banner"> <div class="wrapper"><div class="left-container"> <div class="title-wrapper"> <a class="site-title" rel="author" href="/"> <h1>Ioannis Diamantidis</h1> </a> </div> <div class="footer-icons"> <ul> <li> <div class="social-icon"> <a href="https://twitter.com/diamantidis_io" aria-label="Twitter"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="https://github.com/diamantidis" aria-label="GitHub"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="http://linkedin.com/in/ioannis-diamantidis" aria-label="LinkedIn"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="https://instagram.com/diama.codes" aria-label="Instagram"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-instagram fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="/feed.xml" aria-label="RSS Feed"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-rss fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="mailto:diamantidis@outlook.com" aria-label="Email"> <span class="fa-stack fa-sm"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-envelope fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> </ul> </div> </div><nav class="site-nav"> <input type="checkbox" id="nav-trigger" class="nav-trigger" /> <label for="nav-trigger"> <span class="menu-icon"> <svg viewBox="0 0 18 15" width="18px" height="15px"> <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z" /> </svg> </span> </label> <div class="trigger"> <a class="page-link" href="/tips" title="Tips">Tips</a><a class="page-link" href="/about" title="About">About</a><a class="page-link" href="/archive" title="Archive">Archive</a><a class="page-link" href="/tags" title="Tags">Tags</a></div> </nav></div> </header><main class="page-content" aria-label="Content"> <div class="wrapper"> <article class="post"> <header class="post-header"> <h1> <span class="post-title break-long-word">Help your user rate and review your iOS app!</span> </h1> <div class="post-subheader"> <span class="post-date"> April 5, 2020 </span> <span class="post-divider">-</span> <span class="post-minutes"> 11 min read </span> <div class="outer-post-tags"> <div class="post-tags"> <a class="post-tag" href="/tags#Swift" title="Swift">Swift</a> <a class="post-tag" href="/tags#iOS" title="iOS">iOS</a> </div> </div> </div> </header> <div class="post-content"> <p>Nowadays, more and more users rely on ratings and reviews when they are about to make a purchasing decision, whether it is buying products, deciding on a travel destination, etc. And downloading an app from the App Store could not be an exception to this rule. Having a high rating and many reviews can be a decisive factor on user’s decision to download an app.</p> <p>What are you going to do if you land on the App Store page of an app that seems to fulfill your requirements functionality-wise, but has poor rating and no reviews? Are you going to download it or continue the search, in the hope of finding another app with higher rating and more reviews?</p> <p>On top of that, it is rumored that the rating and number of reviews play an important role on the ranking of your app on App Store’s search and category results. This could also lead to increased downloads as more and more user will visit your app’s App Store page.</p> <p>From all the above, it is quite evident how important having a high rating and many reviews is.</p> <p>Nevertheless, it’s also true that the majority of users who will bother to leave the app and head to the App Store to rate or write a review, are usually the ones who are not satisfied from the app or face an issue while using it.</p> <p>Contrary, users who have a positive experience while using the app, and who are the ones more likely to leave a high rating and a positive review, will continue using the app but are probably less motivated to make the effort to visit the app’s App Store page and rate the app.</p> <p>For this reason, it’s our responsibility as developers to guide those users to rate the app and this is going to be the topic of this post.</p> <h2 id="in-app-review-to-the-rescue">In app review to the rescue</h2> <p>On <code class="language-plaintext highlighter-rouge">iOS 10.3</code>, Apple has introduced the <a href="https://developer.apple.com/documentation/storekit/skstorereviewcontroller">SKStoreReviewController</a>, which provides an easy and native way that allows users to rate and review your app without having to actually leave the app. This is done by presenting a popup that asks the user to rate the app.</p> <p>Let’s see how we can add this in an app.</p> <h2 id="strategy">Strategy</h2> <p>As we mentioned before, we want to show the review popup to users who has a positive experience using the app. Engagement could be one metric for this, so in this post we are going to implement a strategy to present the popup three weeks after the user has installed the app and only if the user has opened the app at least 3 times. Furthermore, we are going to check the bundle version of the app to make sure that we are not asking the user to review the same version of the app more than once.</p> <blockquote> <p>One drawback of the <code class="language-plaintext highlighter-rouge">SKStoreReviewController</code> is that it doesn’t support a way of knowing whether the prompt was presented or not. Apple handles this logic and according to the <a href="https://developer.apple.com/design/human-interface-guidelines/ios/system-capabilities/ratings-and-reviews#system-rating-and-review-prompts">documentation</a>, the only thing that we know is that the prompt will be displayed at most 3 times in 365 days.</p> </blockquote> <p>Let’s dive into the implementation!</p> <h2 id="implementation">Implementation</h2> <p>First, we are going to create a class named <code class="language-plaintext highlighter-rouge">InAppReviewManager</code> which will be responsible for deciding whether we should trigger the review prompt or not.</p> <p>Before we focus on the implementation of the <code class="language-plaintext highlighter-rouge">InAppReviewManager</code>, let’s think about the dependencies. We are probably going to need some storing mechanism to save all the required info (date of first open, number of times the user has opened the app, etc) and we should also be able to retrieve the current version of the app.</p> <p>It would also be great to be able to easily test this class since it is going to contain all the business logic, so ideally it should depend on abstractions instead of concrete classes.</p> <p>For this reason, we are going to define two protocols (<code class="language-plaintext highlighter-rouge">Storage</code> and <code class="language-plaintext highlighter-rouge">BundleType</code>) and provide the required extensions for <code class="language-plaintext highlighter-rouge">UserDefaults</code> and <code class="language-plaintext highlighter-rouge">Bundle</code> respectively to adhere to those protocols.</p> <p>The following snippet contains the definition of <code class="language-plaintext highlighter-rouge">Storage</code> as well the conformance of <code class="language-plaintext highlighter-rouge">UserDefaults</code> to it:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">enum</span> <span class="kt">StorageKey</span><span class="p">:</span> <span class="kt">String</span> <span class="p">{</span>
    <span class="k">case</span> <span class="n">lastVersionPromptedReview</span>
    <span class="k">case</span> <span class="n">dayOfFirstAction</span>
    <span class="k">case</span> <span class="n">actionCount</span>
<span class="p">}</span>

<span class="kd">protocol</span> <span class="kt">Storage</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">integer</span><span class="p">(</span><span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span>
    <span class="kd">func</span> <span class="nf">set</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">object</span><span class="p">(</span><span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">?</span>
    <span class="kd">func</span> <span class="nf">set</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">NSDate</span><span class="p">,</span> <span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span>
    <span class="kd">func</span> <span class="nf">string</span><span class="p">(</span><span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span><span class="p">?</span>
    <span class="kd">func</span> <span class="nf">set</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">UserDefaults</span><span class="p">:</span> <span class="kt">Storage</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">integer</span><span class="p">(</span><span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Int</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="nf">integer</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">set</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">Int</span><span class="p">,</span> <span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">object</span><span class="p">(</span><span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="nf">object</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">set</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">NSDate</span><span class="p">,</span> <span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">string</span><span class="p">(</span><span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">String</span><span class="p">?</span> <span class="p">{</span>
        <span class="k">return</span> <span class="k">self</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
    <span class="p">}</span>

    <span class="kd">func</span> <span class="nf">set</span><span class="p">(</span><span class="n">_</span> <span class="nv">value</span><span class="p">:</span> <span class="kt">String</span><span class="p">,</span> <span class="n">forKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">StorageKey</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="n">key</span><span class="o">.</span><span class="n">rawValue</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>Similarly, in the next snippet, you can find the definition of <code class="language-plaintext highlighter-rouge">BundleType</code> and the conformance of <code class="language-plaintext highlighter-rouge">Bundle</code> to it:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">protocol</span> <span class="kt">BundleType</span> <span class="p">{</span>
    <span class="kd">func</span> <span class="nf">object</span><span class="p">(</span><span class="n">forInfoDictionaryKey</span> <span class="nv">key</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kt">Any</span><span class="p">?</span>
<span class="p">}</span>

<span class="kd">extension</span> <span class="kt">Bundle</span><span class="p">:</span> <span class="kt">BundleType</span> <span class="p">{}</span>
</code></pre></div></div> <p>Now, we can return to the <code class="language-plaintext highlighter-rouge">InAppReviewManager</code> class and provide the implementation, which can be found in the snippet below:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="kt">InAppReviewManager</span> <span class="p">{</span>

    <span class="c1">// MARK: - Initializers</span>
    <span class="nf">init</span><span class="p">(</span><span class="nv">storage</span><span class="p">:</span> <span class="kt">Storage</span> <span class="o">=</span> <span class="kt">UserDefaults</span><span class="o">.</span><span class="n">standard</span><span class="p">,</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kt">BundleType</span> <span class="o">=</span> <span class="kt">Bundle</span><span class="o">.</span><span class="n">main</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">self</span><span class="o">.</span><span class="n">storage</span> <span class="o">=</span> <span class="n">storage</span>
        <span class="k">self</span><span class="o">.</span><span class="n">bundle</span> <span class="o">=</span> <span class="n">bundle</span>
    <span class="p">}</span>

    <span class="c1">// MARK: - Public methods</span>
    <span class="kd">func</span> <span class="nf">shouldAskForReview</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kt">Bool</span> <span class="p">{</span>

        <span class="c1">// Count the number of actions</span>
        <span class="k">var</span> <span class="nv">actionCount</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="nf">integer</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">actionCount</span><span class="p">)</span>
        <span class="n">actionCount</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">storage</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">actionCount</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">actionCount</span><span class="p">)</span>

        <span class="c1">// Store the day of first action</span>
        <span class="k">let</span> <span class="nv">dateOfFirstActionObj</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="nf">object</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">dayOfFirstAction</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dateOfFirstActionObj</span> <span class="o">==</span> <span class="kc">nil</span> <span class="p">{</span>
            <span class="n">storage</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="kt">NSDate</span><span class="p">(),</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">dayOfFirstAction</span><span class="p">)</span>
        <span class="p">}</span>

        <span class="c1">// Calculate if there have been three weeks since the first action</span>
        <span class="k">let</span> <span class="nv">threeWeeksInSeconds</span><span class="p">:</span> <span class="kt">TimeInterval</span> <span class="o">=</span> <span class="mi">3</span> <span class="o">*</span> <span class="mi">7</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">60</span> <span class="o">*</span> <span class="mi">60</span>
        <span class="k">let</span> <span class="nv">threeWeeksAgo</span> <span class="o">=</span> <span class="kt">Date</span><span class="p">(</span><span class="nv">timeIntervalSinceNow</span><span class="p">:</span> <span class="o">-</span><span class="n">threeWeeksInSeconds</span><span class="p">)</span>

        <span class="k">guard</span> <span class="k">let</span> <span class="nv">dateOfFirstAction</span> <span class="o">=</span> <span class="n">dateOfFirstActionObj</span> <span class="k">as?</span> <span class="kt">Date</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span>
        <span class="p">}</span>

        <span class="k">let</span> <span class="nv">comparisonResult</span> <span class="o">=</span> <span class="n">dateOfFirstAction</span><span class="o">.</span><span class="nf">compare</span><span class="p">(</span><span class="n">threeWeeksAgo</span><span class="p">)</span>

        <span class="c1">// Check if user has reviewed this version</span>
        <span class="k">let</span> <span class="nv">bundleVersionKey</span> <span class="o">=</span> <span class="n">kCFBundleVersionKey</span> <span class="k">as</span> <span class="kt">String</span>
        <span class="k">guard</span> <span class="k">let</span> <span class="nv">bundleVersion</span> <span class="o">=</span> <span class="n">bundle</span><span class="o">.</span><span class="nf">object</span><span class="p">(</span><span class="nv">forInfoDictionaryKey</span><span class="p">:</span> <span class="n">bundleVersionKey</span><span class="p">)</span> <span class="k">as?</span> <span class="kt">String</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span>
        <span class="p">}</span>
        <span class="k">let</span> <span class="nv">lastVersion</span> <span class="o">=</span> <span class="n">storage</span><span class="o">.</span><span class="nf">string</span><span class="p">(</span><span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">lastVersionPromptedReview</span><span class="p">)</span>

        <span class="k">guard</span> <span class="k">case</span> <span class="o">.</span><span class="n">orderedAscending</span> <span class="o">=</span> <span class="n">comparisonResult</span><span class="p">,</span> <span class="n">actionCount</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">,</span> <span class="n">lastVersion</span> <span class="o">==</span> <span class="kc">nil</span> <span class="o">||</span> <span class="n">lastVersion</span> <span class="o">!=</span> <span class="n">bundleVersion</span> <span class="k">else</span> <span class="p">{</span>
            <span class="k">return</span> <span class="kc">false</span>
        <span class="p">}</span>

        <span class="n">storage</span><span class="o">.</span><span class="nf">set</span><span class="p">(</span><span class="n">bundleVersion</span><span class="p">,</span> <span class="nv">forKey</span><span class="p">:</span> <span class="o">.</span><span class="n">lastVersionPromptedReview</span><span class="p">)</span>
        <span class="k">return</span> <span class="kc">true</span>
    <span class="p">}</span>

    <span class="c1">// MARK: - Private properties</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">storage</span><span class="p">:</span> <span class="kt">Storage</span>
    <span class="kd">private</span> <span class="k">let</span> <span class="nv">bundle</span><span class="p">:</span> <span class="kt">BundleType</span>
<span class="p">}</span>
</code></pre></div></div> <p>In this snippet, we are using the previously defined protocols to inject the dependencies through the initializer.</p> <p>Then, we have the <code class="language-plaintext highlighter-rouge">shouldAskForReview()</code> method which is responsible to decide whether we should ask the user to review the app or not.</p> <p>In the body of this method, we first retrieve the action count. In our case, this count represents the times the user has opened the app.</p> <p>Then, we retrieve the date of the first trigger of the action. If the value of the variable is <code class="language-plaintext highlighter-rouge">nil</code>, it means that it’s the first open, so we are saving the current date.</p> <blockquote> <p>I am using <code class="language-plaintext highlighter-rouge">NSDate</code> because it’s easier to manipulate the time and time travel using swizzling.</p> </blockquote> <p>As we move on, we are calculating what was the day three weeks ago and compare that with the date of the first trigger of the action.</p> <p>After that, we are fetching the version of the current app as well as the version of the app the time we last triggered the review.</p> <p>Finally, we are checking if all the requirements are met, and if they are, we are updating the version of the app in the storage and return <code class="language-plaintext highlighter-rouge">true</code> to the caller of the function. Otherwise, we return <code class="language-plaintext highlighter-rouge">false</code>.</p> <blockquote> <p>As I pointed before, Apple will show the review popup only 3 times per 365 days, so the above mention implementation will work just fine. Alternatively, you can enrich the logic and in addition to the existing checks, you can add another one for the number of days that has passed since the last time that we have trigger the review popup.</p> </blockquote> <p>Now we are ready to use the <code class="language-plaintext highlighter-rouge">InAppReviewManager</code> like this:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">let</span> <span class="nv">manager</span> <span class="o">=</span> <span class="kt">InAppReviewManager</span><span class="p">()</span>
<span class="k">if</span> <span class="n">manager</span><span class="o">.</span><span class="nf">shouldAskForReview</span><span class="p">()</span> <span class="p">{</span>
    <span class="kt">DispatchQueue</span><span class="o">.</span><span class="n">main</span><span class="o">.</span><span class="nf">asyncAfter</span><span class="p">(</span><span class="nv">deadline</span><span class="p">:</span> <span class="o">.</span><span class="nf">now</span><span class="p">()</span> <span class="o">+</span> <span class="o">.</span><span class="nf">seconds</span><span class="p">(</span><span class="mi">2</span><span class="p">))</span> <span class="p">{</span>
        <span class="kt">SKStoreReviewController</span><span class="o">.</span><span class="nf">requestReview</span><span class="p">()</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <blockquote> <p>To be able to use <code class="language-plaintext highlighter-rouge">SKStoreReviewController</code>, you will have to add <code class="language-plaintext highlighter-rouge">import StoreKit</code>.</p> </blockquote> <p>As a result, if you run the app and satisfy the requirements, the app will show the review popup, which looks like the following screenshots:</p> <p><img src="https://diamantidis.github.io/assets/appreviews/review_without_selection.png" alt="Review without star selection screenshot" />   <img src="https://diamantidis.github.io/assets/appreviews/review_with_selection.png" alt="Review with star selection screenshot" /></p> <blockquote> <p>When in development, you won’t be able to review the app. The prompt will appear but you will not be able to submit the review.</p> </blockquote> <p>These snippets as well as the implementation of some unit tests can be found on GitHub in this <a href="https://gist.github.com/diamantidis/7c615a886acb04b87428a81f9c1029b8">gist</a>.</p> <blockquote> <p>There is an option in Settings where a user can disable In-App Ratings and Reviews. This option is not app specific and it affects all the apps.</p> </blockquote> <h2 id="other-options">Other options</h2> <p>Though <code class="language-plaintext highlighter-rouge">SKStoreReviewController</code> is a great solution, there are certain scenarios where it is not suitable.</p> <p>What if you have to still support versions older than <code class="language-plaintext highlighter-rouge">iOS 10.3</code>? Or you want to have more control over when you ask the users to rate the app? Maybe you want to have a button on the settings to ask the user to review the app.</p> <p>Fortunately, there is a solution. You could lead the users to the iTunes and let them leave a review there. Of course, contrary to <code class="language-plaintext highlighter-rouge">SKStoreReviewController</code>, this solution requires the user to leave the app, and this is one of the drawbacks that we have to take into consideration.</p> <p>iTunes offers a URL that opens the <code class="language-plaintext highlighter-rouge">Write a Review</code> modal automatically and this is what we can use. The format of the url is the following, where appID is the appID of your app:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>https://itunes.apple.com/app/id{appID}?action=write-review
</code></pre></div></div> <p>In the following snippet, you can see an implementation:</p> <div class="language-swift highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">private</span> <span class="kd">func</span> <span class="nf">showItunesReview</span><span class="p">(</span><span class="k">for</span> <span class="nv">appID</span><span class="p">:</span> <span class="kt">String</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">let</span> <span class="nv">appURL</span> <span class="o">=</span> <span class="s">"https://itunes.apple.com/app/</span><span class="se">\(</span><span class="n">appID</span><span class="se">)</span><span class="s">"</span>

    <span class="k">var</span> <span class="nv">components</span> <span class="o">=</span> <span class="kt">URLComponents</span><span class="p">(</span><span class="nv">string</span><span class="p">:</span> <span class="n">appURL</span><span class="p">)</span>

    <span class="n">components</span><span class="p">?</span><span class="o">.</span><span class="n">queryItems</span> <span class="o">=</span> <span class="p">[</span>
        <span class="kt">URLQueryItem</span><span class="p">(</span><span class="nv">name</span><span class="p">:</span> <span class="s">"action"</span><span class="p">,</span> <span class="nv">value</span><span class="p">:</span> <span class="s">"write-review"</span><span class="p">)</span>
    <span class="p">]</span>

    <span class="k">guard</span> <span class="k">let</span> <span class="nv">url</span> <span class="o">=</span> <span class="n">components</span><span class="p">?</span><span class="o">.</span><span class="n">url</span> <span class="k">else</span> <span class="p">{</span>
      <span class="k">return</span>
    <span class="p">}</span>

    <span class="k">if</span> <span class="kt">UIApplication</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">canOpenURL</span><span class="p">(</span><span class="n">url</span><span class="p">)</span> <span class="p">{</span>
        <span class="kt">UIApplication</span><span class="o">.</span><span class="n">shared</span><span class="o">.</span><span class="nf">open</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div> <p>As a result, when this function is called, the App Store app will open, showing the screen in the following screenshot.</p> <p><img src="https://diamantidis.github.io/assets/appreviews/app_store_review.png" alt="App Store &quot;write a review&quot; screenshot" /></p> <h2 id="conclusion">Conclusion</h2> <p>And that’s about it! In this post, I initially stressed the importance of ratings and reviews for any iOS app.</p> <p>Then, we walked through the implementations of two different ways we can use to ask users to rate the app and write a review. In the first one, I am making use of <code class="language-plaintext highlighter-rouge">SKStoreReviewController</code> to trigger the in-app-review prompt, while in the second I am using the <code class="language-plaintext highlighter-rouge">action</code> query parameter to open the review page on App Store.</p> <p>Making it easier for your user to rate the app and with the right strategy in place (when, to which users), it will most likely have a positive impact on the App Store presence of your app and it is something I would totally recommend using.</p> <p>Thanks for reading this post, I hope you find this post useful! Feel free to reach out to me on <a href="https://twitter.com/diamantidis_io">Twitter</a> and share your comments about this post!</p> </div> <div class="socials"> <!-- Buy me a coffee button --> <a href="https://www.buymeacoffee.com/diamantidis" target="_blank"> <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 60px !important;width: 217px !important;" > </a> <div class="share"> <strong>Share: </strong> <a href="//twitter.com/share?text=Help+your+user+rate+and+review+your+iOS+app%21&url=https%3A%2F%2Fdiamantidis.github.io%2F2020%2F04%2F05%2Fapp-reviews-for-iOS-apps" aria-label="Share on Twitter" onclick="window.open(this.href, 'twitter-share', 'width=550,height=255');return false;"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i> </span> </a> <a href="//www.facebook.com/sharer.php?t=Help+your+user+rate+and+review+your+iOS+app%21&u=https%3A%2F%2Fdiamantidis.github.io%2F2020%2F04%2F05%2Fapp-reviews-for-iOS-apps" aria-label="Share on Facebook" onclick="window.open(this.href, 'facebook-share', 'width=550,height=255');return false;"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-facebook fa-stack-1x fa-inverse"></i> </span> </a> <a href="//www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fdiamantidis.github.io%2F2020%2F04%2F05%2Fapp-reviews-for-iOS-apps" aria-label="Share on LinkedIn" onclick="window.open(this.href, 'linkedin-share', 'width=550,height=255');return false;"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </div> </div></article> </div> </main><footer class="site-footer"> <data class="u-url" href="/"></data> <div class="footer-icons"> <ul> <li> <div class="social-icon"> <a href="https://twitter.com/diamantidis_io" aria-label="Twitter"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-twitter fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="https://github.com/diamantidis" aria-label="GitHub"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-github fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="http://linkedin.com/in/ioannis-diamantidis" aria-label="LinkedIn"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="https://instagram.com/diama.codes" aria-label="Instagram"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-instagram fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="/feed.xml" aria-label="RSS Feed"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-rss fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> <li> <div class="social-icon"> <a href="mailto:diamantidis@outlook.com" aria-label="Email"> <span class="fa-stack fa-lg"> <i class="fa fa-circle fa-stack-2x"></i> <i class="fa fa-envelope fa-stack-1x fa-inverse"></i> </span> </a> </div> </li> </ul> </div> <div class="wrapper"> <p>Built with <i class="fa fa-heart" aria-hidden="true"></i>, <a href="https://jekyllrb.com/">Jekyll</a> and <a href="https://pages.github.com/"> Github Pages</a> </p> <p> © Copyright 2024 Ioannis Diamantidis </p> </div> </footer></body> </html>
